

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rabbits and foxes &mdash; Kujenga  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=55fe5824" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="https://cdn.bokeh.org/bokeh/release/bokeh-3.2.0.min.js"></script>
      <script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.2.0.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/CoreAI.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Are healthier people happier people?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html">What you will learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html#differentiation">Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html#a-line-through-the-data">A line through the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html#finding-the-best-fit-line">Finding the best fit line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html#interpretting-the-data">Interpretting the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html#exercise-look-for-other-predictors-of-happiness">Exercise: look for other predictors of happiness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson1/plot_howtobehappy.html#using-regression-in-applications">Using regression in applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Can we predict a disease outbreak?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_epidemic.html">The SIR model</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_SEIR.html">The SEIR model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Are Ethiopian or Kenyan runners the fastest?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lesson3/plot_runners.html">What you will learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson3/plot_runners.html#why-do-we-need-a-test-at-all">Why Do We Need a Test at All?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson3/plot_runners.html#calculating-the-t-statistic-by-hand">Calculating the t-Statistic by Hand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson3/plot_runners.html#doing-it-in-python">Doing it in Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How did Google make billions of dollars?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lesson4/plot_influencer.html">What you will learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson4/plot_influencer.html#the-mathematics-of-the-pagerank-algorithm">The Mathematics of the PageRank algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson4/plot_influencer.html#working-with-matrices-in-python">Working with matrices in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson4/plot_influencer.html#simulating-pagerank">Simulating PageRank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson4/plot_influencer.html#eigenvalues-and-eigenvectors-of-a-matrix">Eigenvalues and eigenvectors of a matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson4/plot_influencer.html#directly-computing-the-pagerank-scores">Directly computing the PageRank scores</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Kujenga</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Rabbits and foxes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/gallery/lesson2/plot_rabbitsandfoxes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-lesson2-plot-rabbitsandfoxes-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="rabbits-and-foxes">
<span id="rabbitsandfoxes"></span><span id="sphx-glr-gallery-lesson2-plot-rabbitsandfoxes-py"></span><h1>Rabbits and foxes<a class="headerlink" href="#rabbits-and-foxes" title="Link to this heading"></a></h1>
<p>In this section we will learn how to write <a class="reference external" href="https://www.khanacademy.org/math/differential-equations">differential equations</a>
models to show the rate of change of populatins of predators and prey. We will simulate the model using Python. Then we draw the phase plane
for the model, just as Parker does in the book in the image shown below.</p>
<img alt="images/lesson2/ParkerCircles.png" src="images/lesson2/ParkerCircles.png" />
<section id="id1">
<h2>Differential equations<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>In the book, I write Lotka’s equations in the form of chemical reactions,
e.g.</p>
<div class="math notranslate nohighlight">
\[\mbox{F} +  \mbox{R} \rightarrow 2 \mbox{F}\]</div>
<p>This means that an F and R together becomes two F’s. My character from Santa Fe, Professor Parker
expalins as follows,</p>
<img alt="images/lesson2/ParkerExplains.png" src="images/lesson2/ParkerExplains.png" />
<p>While in Leipzig, A. J. Lotka learnt how chemical reactions can be used to
specify the rate of change of populations, i.e. in terms of the derivates
above, using an approach, known as the law of mass action.
The idea is to think about the rate at which these chemical reactions take place.
For the first reaction</p>
<div class="math notranslate nohighlight">
\[\mbox{R} \xrightarrow{a} 2 \mbox{R}\]</div>
<p>We can think of <span class="math notranslate nohighlight">\(a\)</span> as being the rate of reproduction of the rabbits,
how many baby rabbits an adult rabbit has per day. So, the rabbits grow
according to</p>
<div class="math notranslate nohighlight" id="equation-rabbitgrow">
<span class="eqno">(1)<a class="headerlink" href="#equation-rabbitgrow" title="Link to this equation"></a></span>\[\frac{dR}{dt} = a R\]</div>
<p>This equation denotes the rate of change of <span class="math notranslate nohighlight">\(R\)</span> over time.
the top part of the fraction <span class="math notranslate nohighlight">\(dR\)</span> denotes the change in rabbits, <span class="math notranslate nohighlight">\(R\)</span>,
and the bottom part, <span class="math notranslate nohighlight">\(dt\)</span>, denotes the change in time, <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
<section id="differentiation-in-school">
<h2>Differentiation in school<a class="headerlink" href="#differentiation-in-school" title="Link to this heading"></a></h2>
<p>This section is somewhat of an aside, but it might be useful if you have studied
differentiation before. I remember that after learning about differentiation in school, I found the form of differential equations above
to be a bit strange when I firstencountered it. In school we might have a function that looks like, for example,</p>
<div class="math notranslate nohighlight" id="equation-timeint">
<span class="eqno">(2)<a class="headerlink" href="#equation-timeint" title="Link to this equation"></a></span>\[X(t) =  b t^2\]</div>
<p>then take the derivative to get</p>
<div class="math notranslate nohighlight" id="equation-timegrow">
<span class="eqno">(3)<a class="headerlink" href="#equation-timegrow" title="Link to this equation"></a></span>\[\frac{dX}{dt} = 2 b t\]</div>
<p>This is also a differential equation. It says that the rate of change of <span class="math notranslate nohighlight">\(X\)</span> over time
is proportional to time. The difference between equation <a class="reference internal" href="#equation-timegrow">(3)</a> and
<a class="reference internal" href="#equation-rabbitgrow">(1)</a> is that <a class="reference internal" href="#equation-timegrow">(3)</a> says that rabbits grow in proportion to time, while
<a class="reference internal" href="#equation-rabbitgrow">(1)</a> says that rabbits grow proportionally to the number of rabbits.</p>
<p>In the case that
rabbits grow in proportion to time, then we say that <a class="reference internal" href="#equation-timeint">(2)</a> is the solution to
equation <a class="reference internal" href="#equation-timegrow">(3)</a> since it tells us how many rabbits there
will be at any point in time. As yet, we haven’t found a solution to equation <a class="reference internal" href="#equation-rabbitgrow">(1)</a>.</p>
<p>I think this is where differential equations can be a bit confusing,
because in school we are usually given <a class="reference internal" href="#equation-timeint">(2)</a> and asked to find <a class="reference internal" href="#equation-timegrow">(3)</a>.
For most differential equations it is the other way round. We are given equation <a class="reference internal" href="#equation-rabbitgrow">(1)</a>
and asked to find the the number of rabbits <span class="math notranslate nohighlight">\(R\)</span> as a function of time.</p>
<p>The solution to equation <a class="reference internal" href="#equation-timegrow">(3)</a> is in fact,</p>
<div class="math notranslate nohighlight" id="equation-expint">
<span class="eqno">(4)<a class="headerlink" href="#equation-expint" title="Link to this equation"></a></span>\[R(t) =  \exp(at)\]</div>
<p>assuming that <span class="math notranslate nohighlight">\(R(0)=1\)</span>
(see <a class="reference external" href="https://www.khanacademy.org/math/differential-equations/first-order-differential-equations/exponential-models-diff-eq/v/modeling-population-with-simple-differential-equation">here</a> for an explanation
of how we get this solution).</p>
<p>In both these cases, we can find an explicit solution for <span class="math notranslate nohighlight">\(R(t)\)</span> in terms of <span class="math notranslate nohighlight">\(t\)</span>. By explicit here
I mean that if you tell me a value of <span class="math notranslate nohighlight">\(t\)</span>, I can put it in to <a class="reference internal" href="#equation-expint">(4)</a> and tell you the number of
rabbits. It is not always the case that we can find an explicit solution.
Indeed, for most differential equation models we can’t find solutions of this form.
This is the case for the rabbits and foxes model which we now look at. We won’t be able to
find an explicit mathematical expression for rabbits and foxes at any time, but we can understand
the dynamics of rabbits and foxes.</p>
</section>
<section id="back-to-rabbits-anf-foxes">
<h2>Back to rabbits anf foxes<a class="headerlink" href="#back-to-rabbits-anf-foxes" title="Link to this heading"></a></h2>
<p>We have an equation for growth of rabbits, now we need to have equations that include foxes.
In chemical reaction form these are,</p>
<div class="math notranslate nohighlight">
\[\mbox{F} +  \mbox{R} \xrightarrow{b}  2 \mbox{F}\]</div>
<p>for foxes eating rabbits and</p>
<div class="math notranslate nohighlight">
\[\mbox{F}   \xrightarrow{d}  \mbox{D}\]</div>
<p>for foxes dying. Converted to differential equations, the rate of change for rabbits becomes</p>
<div class="math notranslate nohighlight" id="equation-rabbits">
<span class="eqno">(5)<a class="headerlink" href="#equation-rabbits" title="Link to this equation"></a></span>\[\frac{dR}{dt} = \underbrace{a R}_{\mbox{R} \xrightarrow{a} 2 \mbox{R}} - \underbrace{b R F}_{\mbox{F} + \mbox{R} \xrightarrow{b} 2 \mbox{F}}\]</div>
<p>Similarly, we can write the rate of change of foxes as</p>
<div class="math notranslate nohighlight" id="equation-foxes">
<span class="eqno">(6)<a class="headerlink" href="#equation-foxes" title="Link to this equation"></a></span>\[\frac{dF}{dt} =  \underbrace{c R F}_{\mbox{F} + \mbox{R} \xrightarrow{c} 2 \mbox{F}} - \underbrace{d F}_{\mbox{F} \xrightarrow{d} \mbox{D}}\]</div>
<p>Notice that we have a different rate parameter for the death of rabbits (<span class="math notranslate nohighlight">\(b\)</span>)
than for the birth of foxes (<span class="math notranslate nohighlight">\(c\)</span>). This is because
it takes more than one rabbit to feed a fox and we set the parameters so that <span class="math notranslate nohighlight">\(c&lt;b\)</span>.</p>
<p>It may seem strange to treat rabbits and foxes as chemicals.
As we all know, two rabbits are needed to produce baby rabbits and when a fox eats a rabbit
it doesn’t simply transform it directly in to a new fox, as the chemical equation suggests.
Also, in the description above, the grass is not depleted: there is no chemical equation
describing how grass is transformed to rabbit poop. But the point of a mathematical model
like this is not to be entirely realistic. Rather, it tries to capture the essence of the problem.
We want to imagine a big grassy meadow, where the more rabbits there are, the faster the rabbit
population grows and the more foxes there are the faster the rabbits are eaten. We will try to
understand this abstract problem first, before we make any claims about what happens to real
rabbits and real foxes.</p>
</section>
<section id="simulating-the-model">
<h2>Simulating the model<a class="headerlink" href="#simulating-the-model" title="Link to this heading"></a></h2>
<p>We can use Python to run a numerical simulation of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the libraries we use</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pylab</span><span class="w"> </span><span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span><span class="o">/</span><span class="mf">2.54</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mf">2.54</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">integrate</span>
</pre></div>
</div>
<p>We start by defining the model. This code creates a function
which we can use to simulate differential equations <a class="reference internal" href="#equation-rabbits">(5)</a> and <a class="reference internal" href="#equation-foxes">(6)</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Differential equation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dXdt</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># Growth rate of fox and rabbit populations.</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">a</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span>      <span class="c1">#Rabbits X[0] is R</span>
                      <span class="n">c</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>   <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>           <span class="c1">#Foxes X[1] is F</span>
</pre></div>
</div>
<p>Next we define the parameter values. You can change these to see how
changes to the paramaters leads to changes in the outcome of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameter values</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Now we solve the equations numerically</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="mi">1000</span><span class="p">)</span>               <span class="c1"># time</span>
<span class="n">X0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>                     <span class="c1"># initially 10 rabbits and 2 foxes</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">R</span><span class="p">,</span> <span class="n">F</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rabbits (R)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">F</span>  <span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Foxes (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time: t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_rabbitsandfoxes_001.png" srcset="../../_images/sphx_glr_plot_rabbitsandfoxes_001.png" alt="plot rabbitsandfoxes" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/Users/davidsumpter/Documents/GitHub/Kujenga/course/lessons/lesson2/plot_rabbitsandfoxes.py:211: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</pre></div>
</div>
<p>First the rabbit populations grow, because there are only two foxes.
But this leads to an increase in foxes. Once the population of foxes is sufficiently
large, they then start reducing rabbit populations and they die out. Then,
when there are few rabbits left, the foxes start to die out too, allowing the rabbit
population to grow again.</p>
<div class="admonition-think-yourself admonition">
<p class="admonition-title">Think yourself!</p>
<p>Download the code and run it. Try changing the paramater values above.
Making <span class="math notranslate nohighlight">\(a\)</span> larger, for example, means the rabbit population
grows faster.</p>
</div>
</section>
<section id="visualising-the-cycle">
<h2>Visualising the cycle<a class="headerlink" href="#visualising-the-cycle" title="Link to this heading"></a></h2>
<p>In the figure above, we show how foxes and rabbits change over time.
We can also plot how they change relative to each other (a so called phase plane).
For the numerical simulations we do this as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plotPhasePlane</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">F</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Rabbits: R&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Foxes: F&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plotPhasePlane</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_rabbitsandfoxes_002.png" srcset="../../_images/sphx_glr_plot_rabbitsandfoxes_002.png" alt="plot rabbitsandfoxes" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/Users/davidsumpter/Documents/GitHub/Kujenga/course/lessons/lesson2/plot_rabbitsandfoxes.py:249: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
</pre></div>
</div>
</section>
<section id="finding-the-equilibrium">
<h2>Finding the equilibrium<a class="headerlink" href="#finding-the-equilibrium" title="Link to this heading"></a></h2>
<p>In order to better understand this cycle we look at
the equilibria (the steady states) where the rate at which rabbits are born equals the rate
at which they die. We can find the rabbit equilibtirum by solving</p>
<div class="math notranslate nohighlight">
\[\frac{dR}{dt} = a R - b R F =0\]</div>
<p>i.e. the number of rabbits does not change over time. This occurs either when
<span class="math notranslate nohighlight">\(R=0\)</span> (all the rabbits are dead) or when <span class="math notranslate nohighlight">\(F=a/b\)</span> (when the number of
foxes is equal to the birth rate of rabbits divided by the rate at which
foxes eat rabbits).</p>
<p>Similarly, we can find the fox equilibtirum by solving</p>
<div class="math notranslate nohighlight">
\[\frac{dF}{dt} = c R F - d F =0\]</div>
<p>i.e. the number of foxes does not change over time. This occurs either when
<span class="math notranslate nohighlight">\(F=0\)</span> (all the foxes are dead) or when <span class="math notranslate nohighlight">\(R=d/c\)</span> (when the number of
rabbits is equal to the death rate of foxes divided by the rate at which
foxes grow after eating rabbits).</p>
<p>We can now plot these equilibrium on the phase plane</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#Plot the rabbit equilibrium</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],[</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="c1">#Plot the fox equilibrium</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">d</span><span class="o">/</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">/</span><span class="n">c</span><span class="p">],[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plotPhasePlane</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_rabbitsandfoxes_003.png" srcset="../../_images/sphx_glr_plot_rabbitsandfoxes_003.png" alt="plot rabbitsandfoxes" class = "sphx-glr-single-img"/><p>We can draw arrows to indicate the direction of change. To
do this, we evaluate <span class="math notranslate nohighlight">\(dR/dt\)</span> and <span class="math notranslate nohighlight">\(dF/dt\)</span>
for different values and plot them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span> <span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">X</span> <span class="p">,</span> <span class="n">Y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">dX</span><span class="p">,</span> <span class="n">dY</span> <span class="o">=</span> <span class="n">dXdt</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span>
<span class="c1">#Make in to unit vectors.</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dX</span><span class="p">,</span><span class="n">dY</span><span class="p">)</span>
<span class="n">dX</span> <span class="o">=</span> <span class="n">dX</span><span class="o">/</span><span class="n">M</span>
<span class="n">dY</span> <span class="o">=</span> <span class="n">dY</span><span class="o">/</span><span class="n">M</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dX</span><span class="p">,</span> <span class="n">dY</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>
<span class="c1">#Plot the rabbit equilibrium</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],[</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="c1">#Plot the fox equilibrium</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">d</span><span class="o">/</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">/</span><span class="n">c</span><span class="p">],[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plotPhasePlane</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_rabbitsandfoxes_004.png" srcset="../../_images/sphx_glr_plot_rabbitsandfoxes_004.png" alt="plot rabbitsandfoxes" class = "sphx-glr-single-img"/></section>
<section id="parker-describe-s-the-cycle">
<h2>Parker describe’s the cycle<a class="headerlink" href="#parker-describe-s-the-cycle" title="Link to this heading"></a></h2>
<p>Here is how Professor Parker sums up what we have learnt in Santa Fe.</p>
<img alt="images/lesson2/ParkerCycle.png" src="images/lesson2/ParkerCycle.png" />
</section>
<section id="describing-the-cycle">
<h2>Describing the cycle<a class="headerlink" href="#describing-the-cycle" title="Link to this heading"></a></h2>
<p>Although we can’t find an explicit solution to the
Lotka-Voltera model in terms of time, we can use a trick that Lotka
described in an article he wrote in <cite>1920 &lt;https://www.pnas.org/doi/full/10.1073/pnas.6.7.410to&gt;</cite>.
By dividing the rabbit equation by the fox equation he got</p>
<div class="math notranslate nohighlight">
\[\frac{dR}{dF} = \frac{aR -bRF}{cRF - d F}\]</div>
<p>We can then rearrange this equation to get</p>
<div class="math notranslate nohighlight">
\[\left(c -d/R \right) dR = \left(a/F -b \right) dF\]</div>
<p>Integrating both sides of this equation we get</p>
<div class="math notranslate nohighlight">
\[cR -d\log(R) = a \log(F) - b F + C\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span>  is the constant of integration. This last equation tells us a relationship that
must always hold between rabbits and foxes. To understand what the relationship implies,
imagine  the equation above was simply <span class="math notranslate nohighlight">\(Y+X=C\)</span>  instead. This would imply the total number of
rabbits and foxes is equal to C=10. So, if <span class="math notranslate nohighlight">\(C=10\)</span> then we could have <span class="math notranslate nohighlight">\(Y=3\)</span> foxes and <span class="math notranslate nohighlight">\(X=7\)</span>
rabbits (because 3+7=10),
or 6 foxes and 4 rabbits (because 6+4=10), but we couldn’t have <span class="math notranslate nohighlight">\(Y=6\)</span> foxes and <span class="math notranslate nohighlight">\(X=7\)</span> rabbits (because 6+7≠10).
In our case, the relationship in the equation is more complicated, involving logarithms,
but the idea is the same: for any particular value of C
all values of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(F\)</span> must obey the equation</p>
<div class="math notranslate nohighlight">
\[C = cR + b F -d\log(R) - a \log(F)\]</div>
<p>This is the case for the cycle we created in our numerical solution above. Every point on
the predator-prey cycle fulfills the condition above.</p>
<p>Here is how Lotka presented his result in the <a class="reference external" href="https://www.pnas.org/doi/full/10.1073/pnas.6.7.410to">original article</a>.</p>
<img alt="images/lesson2/LotkaCurve.png" src="images/lesson2/LotkaCurve.png" />
<p>While Lotka didn’t have a computer to simulate the equations, he could see
using this argument that the cycles would remain finite. Neither the
prey or predator populations would increase without bound.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.362 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-lesson2-plot-rabbitsandfoxes-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f57fa9dfac07dad0cbe79c6ab1db4116/plot_rabbitsandfoxes.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_rabbitsandfoxes.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4ced039a207dcc28058ee6eb7ee81ff4/plot_rabbitsandfoxes.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_rabbitsandfoxes.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, David Sumpter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>